<div class="layui-fluid" id="VIEW-list-table" lay-title="Lista de mesa">
    <div class="layui-row layui-col-space10">
        <div class="layui-col-md10">
            <div class="layui-card">
                <div class="layui-card-body nepadmin-table-full">
                    <div class="layui-btn-container nepadmin-pad-t10 nepadmin-pad-l10">
                        <div class="layui-btn layui-btn-sm">Adicionando bens</div>
                        <div class="layui-btn layui-btn-sm layui-btn-primary table-action" data-type="lower">De prateleira</div>
                        <div class="layui-btn layui-btn-sm layui-btn-primary table-action" data-type="del">Excluir</div>
                        <div class="layui-btn layui-btn-sm layui-btn-primary table-action" data-type="move">Classificação móvel</div>
                        <div class="layui-btn layui-btn-sm layui-btn-primary table-action" data-type="refresh">atualizar a página
                        </div>
                        <div class="layui-btn layui-btn-sm layui-btn-primary action-more">
                            <i class="layui-icon">&#xe875;</i>
                        </div>
                        <div class="layui-btn layui-btn-sm layui-btn-primary">
                            Informação de URL:
                            <script type="text/html" template>
                                {{ JSON.stringify(layui.router()) }}
                            </script>
                        </div>
                    </div>
                    <table id="list-table" lay-filter="list-table"></table>
                </div>
            </div>
        </div>
        <div class="layui-col-md2">
            <div class="layui-card">
                <div class="layui-card-header">Dados de filtro</div>
                <div class="layui-card-body">
                    <div class="layui-row layui-col-space10 layui-form">
                        <div class="layui-col-md12 layui-col-xs4">
                            <select name="type">
                                <option value="">Status de vendas</option>
                                <option value="1">À venda</option>
                                <option value="2">Vendido</option>
                                <option value="3">o armazém</option>
                            </select>
                        </div>
                        <div class="layui-col-md12 layui-col-xs4">
                            <select name="status">
                                <option value="">Tipos de Produto</option>
                                <option value="1">Bens físicos</option>
                                <option value="2">mercadoria virtual</option>
                                <option value="3">Cupom eletrônico</option>
                                <option value="4">Cartão de sócio pago</option>
                                <option value="5">Mercadoria de hotel</option>
                            </select>
                        </div>
                        <div class="layui-col-md12 layui-col-xs4">
                            <select name="group">
                                <option value="">Agrupamento de commodities</option>
                                <option value="1">Novos Produtos</option>
                                <option value="2">Item mais quente</option>
                            </select>
                        </div>
                        <div class="layui-col-md12">
                            <div class="layui-row layui-col-space10">
                                <div class="layui-col-md6 layui-col-xs6">
                                    <input type="text" class="layui-input" placeholder="Vendas mais altas"/>
                                </div>
                                <div class="layui-col-md6 layui-col-xs6">
                                    <input type="text" class="layui-input" placeholder="Vendas mínimas"/>
                                </div>
                            </div>
                        </div>
                        <div class="layui-col-md12 layui-col-xs12">
                            <div class="layui-row layui-col-space10">
                                <div class="layui-col-xs6">
                                    <div class="layui-btn layui-btn-sm layui-btn-fluid">filtro</div>
                                </div>
                                <div class="layui-col-xs6">
                                    <div class="layui-btn layui-btn-sm layui-btn-fluid layui-btn-primary">Redefinir</div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="layui-card nepadmin-font-12">
                <div class="layui-card-header">
                    <i class="layui-icon">&#xe78c;</i> Centro de ajuda
                </div>
                <div class="layui-card-extra">
                    <a>进入</a>
                </div>
                <div class="layui-card-body">
                    <p>Não consegue encontrar o produto na lista de vendas?</p>
                    <p class="nepadmin-c-gray">O estoque esgotado do produto é 0. Na lista esgotado, isso lembra que é hora de adicionar o estoque. Os pedidos de pagamento pendentes também ocuparão o estoque, e o estoque não será liberado até que o tempo limite seja fechado.</p>
                    <hr/>
                    <p>
                        <a>Como criar / publicar produtos?</a>
                    </p>
                    <p>
                        <a>Como gerenciar produtos?</a>
                    </p>
                    <p>
                        <a>Como os produtos são classificados?</a>
                    </p>
                    <p>
                        <a>Não consegue encontrar o pedido correspondente para vendas de produtos?</a>
                    </p>
                    <p>
                        <a>Instruções do código QR do produto</a>
                    </p>
                    <p>
                        <a>As mercadorias podem ser trocadas por pontos?</a>
                    </p>
                </div>
            </div>

        </div>
    </div>
    <script type="text/html" id="TPL-list-table-params">
        {{# layui.each(d.params,function(i,item){ }}
        <span class="layui-badge-rim">{{ item.val }}</span>
        {{# }) }}
    </script>
    <script type="text/html" id="TPL-list-table-status">
        {{#
        var status = {
        WAIT_PAY:{title:'Pagamento Pendente',color:'blue'},
        WAIT_DELIVER:{title:'a ser entregue',color:'orange'},
        WAIT_REFUND:{title:'Reembolso pendente',color:'red'},
        }[d.status];
        }}
        <span class="layui-badge layui-bg-{{status.color}}">{{ status.title }}</span>
    </script>
</div>
<script>
    layui.use(['admin', 'table', 'form', 'dropdown', 'jquery'], function (admin, table, form, dropdown, $) {
        var view = $('#VIEW-list-table');

        var tableFilter = 'list-table';
        form.render();
        table.render({
            elem: '[lay-filter="' + tableFilter + '"]',
            api: 'getGoods',
            height: 'full-165',
            cols: [[
                {title: '', type: 'checkbox', fixed: true, width: 60},
                {title: '状态', templet: '#TPL-list-table-status', width: 80},
                {title: '商品名称', field: 'title', minWidth: 300},
                {title: '商品参数', templet: '#TPL-list-table-params', minWidth: 240},
                {
                    title: '商品单价',
                    templet: '<p><b class="nepadmin-c-red">￥{{d.price}}</b></p>',
                    align: 'center',
                    width: 90
                },
                {
                    title: '购买数量',
                    templet: '<p><b>{{d.buycount}}</b> <span class="nepadmin-c-gray">件</span></p>',
                    align: 'center',
                    width: 90
                },
                {
                    field: 'time',
                    title: '操作时间',
                    templet: '<p><span title="{{d.time}}" class="nepadmin-c-gray">{{ layui.util.timeAgo(d.time)}}</span></p>',
                    align: 'center',
                    width: 170
                }
            ]]
        });


        dropdown.render({
            elem: view.find('.action-more'),
            click: function (name, elem, event) {
            },
            options: [{
                name: 'action1',
                title: 'Menu 1'
            }, {
                name: 'action2',
                title: 'Menu 2',
                options: [{
                    name: 'action3',
                    title: 'Menu 3',
                }, {
                    name: 'action4',
                    title: 'Menu 4',
                }]
            }]
        });

        view.find('.table-action').click(function () {
            var type = $(this).attr('data-type')
            if (type == 'refresh') {
                //刷新当前页
                layui.view.tab.refresh()

                //刷新一个指定页，不用传入页面的参数
                //layui.view.tab.refresh('/index')

                return false;
            }
            var checkedCount = table.checkStatus(tableFilter).data.length;
            if (checkedCount == 0) {
                layer.msg('请先选择某行');
            } else {
                layer.msg($(this).html() + checkedCount + '项');
            }
        })


    })
</script>